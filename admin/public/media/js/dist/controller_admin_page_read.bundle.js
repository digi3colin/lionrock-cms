(()=>{"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var a=function(){function t(){e(this,t)}return n(t,null,[{key:"saveScroll",value:function(){sessionStorage.setItem("adminPageScroll",window.scrollY.toString()),sessionStorage.setItem("adminPageExit",window.location.href.split("?")[0])}},{key:"restoreScroll",value:function(){var e=sessionStorage.getItem("adminPageScroll");if(e){if(sessionStorage.getItem("adminPageExit")!==window.location.href.split("?")[0])return;window.scrollTo({top:parseInt(e)})}}},{key:"saveOnSubmit",value:function(e){var t=this;e.addEventListener("submit",(function(){t.saveScroll()}))}}]),t}(),o=function(){function t(){e(this,t)}return n(t,null,[{key:"enableAutoSave",value:function(){var e=document.getElementById("autosave");e&&e.addEventListener("change",(function(e){e.currentTarget.form.submit()}))}},{key:"enablePointers",value:function(){var e=document.querySelector("html").getAttribute("lang");document.querySelectorAll("select.ref-pages").forEach((function(t){var n=t.getAttribute("data-pagetype");fetch("/admin/api/pages/".concat(n,"?language=").concat(e)).then((function(e){e.json().then((function(e){console.log(e)}))})),console.log(t)})),document.querySelectorAll("select.ref-page-items").forEach((function(t){var n=t.innerHTML,a=t.getAttribute("data-value"),o=t.getAttribute("data-pagetype"),r=t.getAttribute("data-item"),c="/admin/api/page-items/".concat(o,"/").concat(r,"?language=").concat(e);t.innerHTML='<option value="">Loading...</option>',fetch(c).then((function(e){e.json().then((function(e){var o=[n];e.forEach((function(e){o.push('<optgroup label="'.concat(e.name,'">')),e.items.forEach((function(e){o.push('<option value="'.concat(e.id,'" ').concat(e.id.toString()===a?"selected":"",">").concat(e.name,"</option>"))})),o.push("</optgroup>")})),t.innerHTML=o.join("/n")}))}))}))}},{key:"enableBlock",value:function(){var e=document.getElementById("add-block");if(e){var t=e.querySelector("select"),n=e.querySelector("a");t.addEventListener("change",(function(){n.setAttribute("href",n.getAttribute("data-link").replace("[block_name]",t.value))}))}}},{key:"addPageTag",value:function(e,t,n){fetch("/admin/api/page/".concat(e,"/tag/").concat(t),{credentials:"include",method:"POST"}).then((function(e){return e.json().then((function(e){console.log(e),!0===e.payload.success&&n(e.payload)}))}))}},{key:"enablePageTag",value:function(){var e=this;document.querySelectorAll(".page-tag-form").forEach((function(t){var n=t.getAttribute("data-page"),a=t.querySelector(".tag-add-input"),o=t.querySelector(".page-tag-list"),r=function(e){var t=e.currentTarget;fetch("/admin/api/page_tag/".concat(t.getAttribute("data-id")),{credentials:"include",method:"DELETE"}).then((function(e){return e.json().then((function(e){console.log(e),t.remove()}))}))};t.querySelector(".toggle-input-tag").addEventListener("click",(function(e){a.classList.contains("visually-hidden")?a.classList.remove("visually-hidden"):a.classList.add("visually-hidden")})),t.querySelectorAll(".page-tag.badge").forEach((function(e){e.addEventListener("click",r)})),a.addEventListener("change",(function(){var c=t.querySelector('option[value="'.concat(a.value,'"]'));if(c){var i=c.getAttribute("data-id"),l=c.getAttribute("data-value"),u=c.getAttribute("data-name");e.addPageTag(n,i,(function(e){var t=document.createElement("span");t.value="".concat(l," ( ").concat(u," )"),t.setAttribute("data-id",e.id),t.setAttribute("role","button"),t.classList.add("badge","bg-primary","rounded-pill"),t.innerHTML="".concat(l,' <i class="fas fa-times"></i>'),o.appendChild(t),o.appendChild(document.createTextNode(" ")),a.value="",t.addEventListener("click",r)}))}}))}))}}]),t}();function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(){function t(){e(this,t)}return n(t,null,[{key:"enableUpload",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i({apiKey:"api",dir:"cms",selector:".page-field-upload",selectorFile:'input[type="file"]',callback:function(e,n,a){if(e)throw e;var o=a.files[0],r=n.querySelector(".page-field-upload-text"),c=n.querySelector(".preview img");r.value="/".concat(o),c&&(c.src="".concat(t.previewUrl||"https://www.example.com").concat(o))}},t),a=document.querySelectorAll(n.selector);a.forEach((function(t){var a=t.querySelector(n.selectorFile);a.addEventListener("change",(function(){var o=new FormData;o.append("file",a.files[0]),o.append("dir",n.dir),o.append("api-key",n.apiKey),fetch(e,{method:"POST",body:o,mode:"cors"}).then((function(e){e.json().then((function(e){var a=e.files[0];if(!a)return n.callback(new Error("upload error"),t,a);n.callback(null,t,e)}))})).catch((function(e){return n.callback(e,t,null)}))}),!1)}))}}]),t}();a.restoreScroll(),a.saveOnSubmit(document.getElementById("main-form")),o.enableAutoSave(),o.enablePageTag(),l.enableUpload({"www2-admin.occasionspr.com":"https://mediaport.dappod.com/upload","www-admin.occasionspr.com":"https://mediaport.dappod.com/upload"}[window.location.hostname]||"/admin/upload",{apiKey:{"www2-admin.occasionspr.com":"occadmintest","www-admin.occasionspr.com":"occadmin"}[window.location.hostname]||"occadmin",dir:"cms",previewUrl:window.location.origin+"/"}),tinymce.init({selector:"textarea",menubar:"",branding:!1,width:"100%",plugins:"code",toolbar:"undo redo bold italic removeformat code",paste_as_text:!0}).then()})();
//# sourceMappingURL=controller_admin_page_read.bundle.js.map